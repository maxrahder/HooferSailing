(function(){var t=Math.PI,a=Math.sin,b=Math.cos,y=Math.tan,n=Math.asin,j=Math.atan2,q=Math.acos,C=t/180;var A=1000*60*60*24,f=2440588,F=2451545;function u(e){return e.valueOf()/A-0.5+f}function B(e){return new Date((e+0.5-f)*A)}function i(e){return u(e)-F}var z=C*23.4397;function g(H,e){return j(a(H)*b(z)-y(e)*a(z),b(H))}function o(H,e){return n(a(e)*b(z)+b(e)*a(z)*a(H))}function v(e,I,J){return j(a(e),b(e)*a(I)-y(J)*b(I))}function k(e,I,J){return n(a(I)*a(J)+b(I)*b(J)*b(e))}function w(H,e){return C*(280.16+360.9856235*H)-e}function E(e){return C*(357.5291+0.98560028*e)}function s(I){var H=C*(1.9148*a(I)+0.02*a(2*I)+0.0003*a(3*I)),e=C*102.9372;return I+H+e+t}function x(H){var I=E(H),e=s(I);return{dec:o(e,0),ra:g(e,0)}}var h={};h.getPosition=function(I,M,e){var L=C*-e,K=C*M,N=i(I),O=x(N),J=w(N,L)-O.ra;return{azimuth:v(J,K,O.dec),altitude:k(J,K,O.dec)}};var m=h.times=[[-0.833,"sunrise","sunset"],[-0.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];h.addTime=function(H,I,e){m.push([H,I,e])};var d=0.0009;function r(H,e){return Math.round(H-d-e/(2*t))}function p(e,H,I){return d+(e+H)/(2*t)+I}function c(H,I,e){return F+H+0.0053*a(I)-0.0069*a(2*e)}function D(e,H,I){return q((a(e)-a(H)*a(I))/(b(H)*b(I)))}function l(J,H,K,I,e,N,O){var Q=D(J,K,I),P=p(Q,H,e);return c(P,N,O)}h.getTimes=function(Y,I,Z){var H=C*-Z,e=C*I,W=i(Y),S=r(W,H),R=p(0,H,S),K=E(R),N=s(K),Q=o(N,0),X=c(R,K,N),U,V,J,P,T;var O={solarNoon:B(X),nadir:B(X-0.5)};for(U=0,V=m.length;U<V;U+=1){J=m[U];P=l(J[0]*C,H,e,Q,S,K,N);T=X-(P-X);O[J[1]]=B(T);O[J[2]]=B(P)}return O};function G(N){var H=C*(218.316+13.176396*N),O=C*(134.963+13.064993*N),K=C*(93.272+13.22935*N),I=H+C*6.289*a(O),e=C*5.128*a(K),J=385001-20905*b(O);return{ra:g(I,e),dec:o(I,e),dist:J}}h.getMoonPosition=function(I,N,O){var e=C*-O,K=C*N,L=i(I),M=G(L),P=w(L,e)-M.ra,J=k(P,K,M.dec);J=J+C*0.017/y(J+C*10.26/(J+C*5.1));return{azimuth:v(P,K,M.dec),altitude:J,distance:M.dist}};h.getMoonIllumination=function(H){var N=i(H),I=x(N),e=G(N),K=149598000,J=q(a(I.dec)*a(e.dec)+b(I.dec)*b(e.dec)*b(I.ra-e.ra)),L=j(K*a(J),e.dist-K*b(J)),M=j(b(I.dec)*a(I.ra-e.ra),a(I.dec)*b(e.dec)-b(I.dec)*a(e.dec)*b(I.ra-e.ra));return{fraction:(1+b(L))/2,phase:0.5+0.5*L*(M<0?-1:1)/Math.PI,angle:M}};if(typeof define==="function"&&define.amd){define(h)}else{if(typeof module!=="undefined"){module.exports=h}else{window.SunCalc=h}}}());